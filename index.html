<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Two-Week Planner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; }

    body {
      font-family: sans-serif;
      margin: 0;
      padding: 1rem;
      background: #121212;
      color: #e0e0e0;
    }

    .controls {
      margin: 0.5rem 0;
    }

    .controls button {
      background: #333;
      color: #e0e0e0;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 0.5rem;
    }

    .day {
      border: 1px solid #333;
      background: #1e1e1e;
      min-height: 150px;
      padding: 5px;
      position: relative;
      display: flex;
      flex-direction: column;
    }

    .day h3 {
      margin: 0 0 5px 0;
      font-size: 0.9rem;
      color: #e0e0e0;
    }

    .tile {
      background: #ffdcdc;
      color: #000;
      padding: 0.5rem;
      margin: 3px 0;
      border-radius: 6px;
      cursor: move;
      box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.1);
      position: relative;
      user-select: none;
      width: 100%;
      min-height: 3.5rem;
    }

    .tile[contenteditable="true"] {
      outline: none;
    }

    .tile button {
      position: absolute;
      top: 2px;
      background: transparent;
      border: none;
      cursor: pointer;
      font-size: 14px;
    }

    .tile .del-btn {
      right: 2px;
      color: #000;
      font-weight: bold;
    }
    .tile .color-btn {
      right: 26px;
      color: #e0e0e0;
    }

    /* Color picker menu */
    .color-menu {
      position: absolute;
      top: 24px;
      right: 26px;
      background: #333;
      padding: 4px;
      border: 1px solid #555;
      border-radius: 4px;
      display: none;
      gap: 4px;
    }
    .color-menu.show {
      display: flex;
    }
    .swatch {
      width: 16px;
      height: 16px;
      border-radius: 3px;
      cursor: pointer;
      border: 1px solid #666;
    }
    .swatch.color-0 { background: #ffdcdc; }
    .swatch.color-1 { background: #fff4c2; }
    .swatch.color-2 { background: #dcffe4; }
    .swatch.color-3 { background: #dceaff; }
    .swatch.color-4 { background: #f0dcff; }
    .swatch.color-5 { background: #ffebdc; }

    .holding-area {
      margin-top: 2rem;
      padding: 1rem;
      background: #2a2a2a;
      min-height: 120px;
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div id="calendar" class="calendar"></div>

  <h3>Holding Area</h3>
  <div class="controls">
    <button onclick="createTile()">âž• Create Tile</button>
  </div>
  <div id="holdingArea" class="holding-area" ondragover="allowDrop(event)" ondrop="drop(event, null)"></div>

  <script>
    const days = [
      'Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'
    ];
    const dates = [
      'July 27', 'July 28', 'July 29', 'July 30', 'July 31', 'August 1', 'August 2',
      'August 3', 'August 4', 'August 5', 'August 6', 'August 7', 'August 8', 'August 9'
    ];
    const pastelColors = [0, 1, 2, 3, 4, 5];

    let state = JSON.parse(localStorage.getItem("calendarState") || "{}");

    const calendarEl = document.getElementById("calendar");
    const holdingAreaEl = document.getElementById("holdingArea");

    function renderCalendar() {
      calendarEl.innerHTML = "";
      for (let i = 0; i < 14; i++) {
        const dayBox = document.createElement("div");
        dayBox.className = "day";
        dayBox.dataset.date = dates[i];
        dayBox.ondragover = allowDrop;
        dayBox.ondrop = (e) => drop(e, dates[i]);

        const title = document.createElement("h3");
        title.innerText = `${days[i % 7]} (${dates[i]})`;
        dayBox.appendChild(title);

        calendarEl.appendChild(dayBox);
      }
    }

    function createTile(text = "New Activity", color = 0, location = null) {
      const id = `tile-${Date.now()}-${Math.random().toString(36).substr(2, 5)}`;
      const tileData = { id, text, color, location };
      state[id] = tileData;
      renderTile(tileData);
      saveState();
    }

    function renderTile(data) {
      const tile = document.createElement("div");
      tile.className = `tile color-${data.color}`;
      tile.draggable = true;
      tile.contentEditable = true;
      tile.innerText = data.text;
      tile.dataset.id = data.id;

      // delete button
      const del = document.createElement("button");
      del.className = "del-btn";
      del.innerText = "X";
      del.onclick = (e) => {
        e.stopPropagation();
        delete state[data.id];
        tile.remove();
        saveState();
      };

      // color picker button and menu
      const colorBtn = document.createElement("button");
      colorBtn.className = "color-btn";
      colorBtn.innerText = "ðŸŽ¨";
      const menu = document.createElement("div");
      menu.className = "color-menu";
      pastelColors.forEach(i => {
        const swatch = document.createElement("div");
        swatch.className = `swatch color-${i}`;
        swatch.dataset.color = i;
        swatch.onclick = (ev) => {
          ev.stopPropagation();
          state[data.id].color = parseInt(swatch.dataset.color);
          renderAll();
          saveState();
        };
        menu.appendChild(swatch);
      });
      colorBtn.onclick = (e) => {
        e.stopPropagation();
        menu.classList.toggle('show');
      };

      // drag & edit events
      tile.addEventListener("dragstart", (e) => {
        e.dataTransfer.setData("text/plain", data.id);
      });
      tile.addEventListener("input", () => {
        state[data.id].text = tile.innerText.trim();
        saveState();
      });
      tile.addEventListener("click", () => { tile.draggable = false; });
      tile.addEventListener("blur", () => { tile.draggable = true; });

      tile.appendChild(del);
      tile.appendChild(colorBtn);
      tile.appendChild(menu);

      // placement
      if (data.location === null) {
        holdingAreaEl.appendChild(tile);
      } else {
        const dayBox = [...calendarEl.children].find(d => d.dataset.date === data.location);
        if (dayBox) dayBox.appendChild(tile);
        else holdingAreaEl.appendChild(tile);
      }
    }

    function allowDrop(e) { e.preventDefault(); }
    function drop(e, date) { e.preventDefault(); const id = e.dataTransfer.getData("text/plain"); state[id].location = date; renderAll(); saveState(); }
    function renderAll() { renderCalendar(); Object.values(state).forEach(renderTile); }
    function saveState() { localStorage.setItem("calendarState", JSON.stringify(state)); }
    renderAll();
  </script>
</body>
</html>
